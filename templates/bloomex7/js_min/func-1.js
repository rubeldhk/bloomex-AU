var $j=jQuery.noConflict();$j(document).ready(function(){$j(".add-to-cart").click(function(){var formId=$j(this).attr("name");var product_id_value=$j("input[name='product_id_"+formId+"']").val();var category_id_value=$j("input[name='category_id_"+formId+"']").val();var quantity_value=$j("input[name='quantity_"+formId+"']").val();var price_value=$j("input[name='price_"+formId+"']").val();var select_bouquet=$j("[name='select_bouquet']").is(':checked')?$j("[name='select_bouquet']:checked").val():'standard';var extra_touches=$j('input[name="extra_products"]').is(':checked')?$j('input[name="extra_products"]:checked').serialize():0;if(parseInt(quantity_value)<0||!isInteger(quantity_value)){alert("Please enter quantity number!");return;}$j.post("index.php",{option:"com_virtuemart",page:"shop.cart",func:"cartadd",action:"ajax",product_id:product_id_value,category_id:category_id_value,quantity:quantity_value,price:price_value,select_bouquet:select_bouquet,extra_touches:extra_touches,ajaxSend:function(){$j("#div_"+formId).html('<img src="'+sImgLoading+'" align="absmiddle" height="53"/>&nbsp;&nbsp;'+sVM_UPDATING);}},function(data){aData=data.split("[--1--]");if(aData[0]=="success"){if(sLang=='french'){sLangClass="-fr";sShortLang="fr";}else{sLangClass="";sShortLang="en";}sCartLink=sSecurityUrl+"index.php?page=shop.cart&option=com_virtuemart&Itemid=80&lang="+sShortLang;$j("#div_"+formId).html(sVM_ADD_PRODUCT_SUCCESSFUL+"<br/><center><a class='show-cart-now"+sLangClass+"' href='"+sCartLink+"'>&nbsp;</a></center>");$j("#modCartItem").html(aData[1]);}else{$j("#div_"+formId).html(sVM_ADD_PRODUCT_UNSUCCESSFUL);}});});$j(".delete-cart-item").click(function(){var product_id_value=$j(this).attr("rel");if(!confirm(sVM_CONFIRM_DELETE)){return;}$j.post("index.php",{option:"com_virtuemart",page:"shop.cart",func:"cartDelete",action:"ajax",product_id:product_id_value,ajaxSend:function(){$j("#msgReportBlock_"+product_id_value).html('<img src="'+sImgLoading+'" align="absmiddle"/><br/>'+sVM_DELETING);}},function(data){aData=data.split("[--1--]");if(aData[0]=="success"){if(current_page!="shop.cart"){location.href=sSecurityUrl+"index.php?page=checkout.index&option=com_virtuemart&Itemid=80&reload=1&cart_msg="+sVM_DELETE_SUCCESSFUL;}else{location.href=sSecurityUrl+"index.php?page=shop.cart&option=com_virtuemart&Itemid=80&cart_msg="+sVM_DELETE_SUCCESSFUL;}}else{$j("#msgReport").css('display','none');$j("#msgReportBlock_"+product_id_value).html(sVM_DELETE_UNSUCCESSFUL);}});});$j(".update-cart-item").click(function(){var product_id_value=$j(this).attr("rel");var quantity_value=$j("input[name='quantity_"+product_id_value+"']").val();if(parseInt(quantity_value)<0||!isInteger(quantity_value)){alert(sVM_CONFIRM_QUANTITY);return;}$j.post("index.php",{option:"com_virtuemart",page:"shop.cart",func:"cartUpdate",action:"ajax",product_id:product_id_value,quantity:quantity_value,ajaxSend:function(){$j("#msgReportBlock_"+product_id_value).html('<img src="'+sImgLoading+'" align="absmiddle"/><br/>'+sVM_UPDATING);}},function(data){aData=data.split("[--1--]");if(aData[0]=="success"){if(current_page!="shop.cart"){location.href=sSecurityUrl+"index.php?page=checkout.index&option=com_virtuemart&Itemid=80&reload=1&cart_msg="+sVM_UPDATE_CART_ITEM_SUCCESSFUL;}else{location.href=sSecurityUrl+"index.php?page=shop.cart&option=com_virtuemart&Itemid=80&cart_msg="+sVM_UPDATE_CART_ITEM_SUCCESSFUL;}}else if(aData[0]=="error"){$j("#msgReportBlock_"+product_id_value).html(aData[1]);}else{$j("#msgReportBlock_"+product_id_value).html(sVM_UPDATE_CART_ITEM_UNSUCCESSFUL);}});});$j("#displayUpdateBillingInfo").click(function(){$j.post("index.php",{option:"com_ajaxorder",task:"getUserBillingAddress",user_id:$j("input[name='user_id_billing']").val(),user_info_id:$j("input[name='user_info_id_billing']").val()},function(data){aData=data.split("[--1--]");if($j.trim(aData[0])=="success"){aData2=aData[1].split("[--2--]");$j("input[name='user_info_id_shipping']").val(aData2[1]);$j("input[name='first_name_billing']").val(aData2[3]);$j("input[name='last_name_billing']").val(aData2[4]);$j("input[name='company_billing']").val(aData2[6]);$j("input[name='city_billing']").val(aData2[9]);$j("input[name='zip_billing']").val(aData2[10]);$j("select[name='country_billing']").val(aData2[11]);changeStateList("state_billing","country_billing");$j("select[name='state_billing']").val(aData2[12]);$j("input[name='phone_1_billing']").val(aData2[13]);$j("input[name='phone_2_billing']").val(aData2[14]);$j("input[name='email_billing']").val(aData2[17]);$j("input[name='address_suite_billing']").val(aData2[18]);$j("input[name='address_street_number_billing']").val(aData2[19]);$j("input[name='address_street_name_billing']").val(aData2[20]);$j('#updateBillingInfoForm').modal({onOpen:modalOpen,position:["25%","25%"]});}else{}});});$j("#btnSelectDeliveryOption").click(function(){if($j("input[name='delivery_date_2']").val()!=''){var delivery_date=$j("input[name='delivery_date_2']").val();}else{var delivery_date=nMonthsValid+"/"+nDaysValid+"/"+nYearsValid;}var del_state=$j("input[name='current_state_tax']").val().split('_');$j.post("index.php",{option:"com_ajaxorder",task:"selectDeliveryOption",delivery_date:delivery_date,delivery_default_date:nMonthsValid+"/"+nDaysValid+"/"+nYearsValid,delivery_postalcode:$j("input[name='zip_checked_value']").val(),delivery_state:del_state[1],shipping_method:$j("input[name='shipping_method']").val(),subtotalprice:$j("input[name='sub_total_price']").val(),user_info_id:$j("input[name='ship_to_info_id']:checked").val()},function(data){$j('#selectDeliveryOption').html(data);$j("#selectDeliveryOption").css('display','block');$j('#selectDeliveryOption').modal({onOpen:modalOpen,onClose:closeCalendar(),position:["25%","25%"],containerId:'selectDeliveryOptionContainer',containerCss:'selectDeliveryOptionContainer'});});});function closeCalendar(){$j("#selectDeliveryOption").css('display','none');}$j("#updateBillingInfo").click(function(){var id_value=$j("input[name='id_billing']").val();var user_id_value=$j("input[name='user_id_billing']").val();var user_info_id_value=$j("input[name='user_info_id_billing']").val();var company_value=$j("input[name='company_billing']").val();var first_name_value=$j("input[name='first_name_billing']").val();var last_name_value=$j("input[name='last_name_billing']").val();var address_suite=$j("input[name='address_suite_billing']").val();var address_street_number=$j("input[name='address_street_number_billing']").val();var address_street_name=$j("input[name='address_street_name_billing']").val();var city_value=$j("input[name='city_billing']").val();var zip_value=$j("input[name='zip_billing']").val();var country_value=$j("select[name='country_billing']").val();var state_value=$j("select[name='state_billing']").val();var phone_1_value=$j("input[name='phone_1_billing']").val();var phone_2_value=$j("input[name='phone_2_billing']").val();var email_value=$j("input[name='email_billing']").val();if(first_name_value==""){alert(sVM_CONFIRM_FIRST_NAME);$j('#first_name_field').css("color","red");return;}else{$j('#first_name_field').css("color","");}if(last_name_value==""){alert(sVM_CONFIRM_LAST_NAME);$j('#last_name_field').css("color","red");return;}else{$j('#last_name_field').css("color","");}if(address_street_number==""){alert('Please enter street number');$j('#address_street_number_po').css("color","red");return;}else{$j('#address_street_number_po').css("color","");}if(address_street_name==""){alert('Please enter street name');$j('#address_street_name_po').css("color","red");return;}else{$j('#address_street_name_po').css("color","");}if(city_value==""){alert(sVM_CONFIRM_CITY);$j('#city_field').css("color","red");return;}else{$j('#city_field').css("color","");}if(zip_value==""){alert(sVM_CONFIRM_ZIP_CODE);$j('#zip_field').css("color","red");return;}else{$j('#zip_field').css("color","");}if(!isValidZipCode(zip_value)){alert(sVM_CONFIRM_VALID_ZIP_CODE);$j('#zip_field').css("color","red");return;}else{$j('#zip_field').css("color","");}if(country_value==""){alert(sVM_CONFIRM_COUNTRY);$j('#td_country_field').css("color","red");return;}else{$j('#td_country_field').css("color","");}if(state_value==""||state_value=="NA"){alert(sVM_CONFIRM_STATE);$j('#td_state_field').css("color","red");return;}else{$j('#td_state_field').css("color","");}if(phone_1_value==""){alert(sVM_CONFIRM_PHONE_NUMBER);$j('#phone_1_field').css("color","red");return;}else{$j('#phone_1_field').css("color","");}if(!(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/.test(email_value))){alert(sVM_CONFIRM_EMAIL);$j('#email_field').css("color","red");return;}else{$j('#email_field').css("color","");}$j.post("index.php",{option:"com_virtuemart",page:"checkout.index",func:"shopperupdate",action:"ajax",address_type:"BT",id:id_value,user_id:user_id_value,user_info_id:user_info_id_value,company:company_value,first_name:first_name_value,last_name:last_name_value,address_suite:address_suite,address_street_number:address_street_number,address_street_name:address_street_name,city:city_value,zip:zip_value,country:country_value,state:state_value,phone_1:phone_1_value,phone_2:phone_2_value,email:email_value,gid:18,ajaxSend:function(){$j("#msgReportUpdateBilling").css('display','block');$j("#msgReportUpdateBilling").html('<img width="24" src="'+sImgLoading+'" align="absmiddle"/>&nbsp;&nbsp;'+sVM_UPDATING_BILLING_INFO);}},function(data){if(data=="success"){$j("#company_field_value").html(company_value);$j("#name_field_value").html(first_name_value+' '+last_name_value);var str='';if(address_suite.length>0){str=address_suite+',';}$j("#address_field_value").html(str+address_street_number+' '+address_street_name+' '+city_value+', '+state_value+', '+country_value);$j("#phone_field_value").html(phone_1_value);$j("#email_field_value").html(email_value);$j("#msgReportUpdateBilling").css('display','block');$j("#msgReportUpdateBilling").html(sVM_UPDATE_BILLING_INFO_SUCCESSFUL);$j.modal.close();}else{$j("#msgReportUpdateBilling").css('display','block');$j("#msgReportUpdateBilling").html(sVM_UPDATE_BILLING_INFO_UNSUCCESSFUL);}});});$j("#closeShippingInfo").click(function(){$j.modal.close();});$j(".add-shipping-address").click(function(){$j("select[name='address_type2']").val("R");$j("input[name='first_name_shipping']").val("");$j("input[name='last_name_shipping']").val("");$j("input[name='company_shipping']").val("");$j("input[name='address_suite']").val("");$j("input[name='address_street_number']").val("");$j("input[name='address_street_name']").val("");$j("input[name='city_shipping']").val("");$j("input[name='zip_shipping']").val("");$j("select[name='country_shipping']").val("AUS");changeStateList("state_shipping","country_shipping");$j("select[name='state_shipping']").val("AT");$j("input[name='phone_1_shipping']").val("");$j("input[name='phone_2_shipping']").val("");$j("input[name='email_shipping']").val("");$j("input[name='func_shipping']").val("userAddressAdd");sCurrentZipChecked=$j("input[name='ship_to_info_id']:checked").val();$j('#addShippingInfoForm').modal({onOpen:modalOpen,position:["25%","25%"]});$j("#updateShippingInfo").attr("value",sVM_ADD_ADDRESS);});$j("#updateShippingInfo").click(function(){var address_type2=$j("select[name='address_type2']").val();var func_shipping_value=$j("input[name='func_shipping']").val();var user_id_value=$j("input[name='user_id_shipping']").val();var user_info_id_value=$j("input[name='user_info_id_shipping']").val();var first_name_shipping_value=$j("input[name='first_name_shipping']").val();var last_name_shipping_value=$j("input[name='last_name_shipping']").val();var company_shipping_value=$j("input[name='company_shipping']").val();var address_suite=$j("input[name='address_suite']").val();var address_street_number=$j("input[name='address_street_number']").val();var address_street_name=$j("input[name='address_street_name']").val();var city_shipping_value=$j("input[name='city_shipping']").val();var zip_shipping_value=$j("input[name='zip_shipping']").val();var country_shipping_value=$j("input[name='country_shipping']").val();var state_shipping_value=$j("select[name='state_shipping']").val();var phone_1_shipping_value=$j("input[name='phone_1_shipping']").val();var phone_2_shipping_value=$j("input[name='phone_2_shipping']").val();var email_shipping_value=$j("input[name='email_shipping']").val();if(address_type2==""){alert(sVM_CONFIRM_ADDRESS_TYPE_2);$j('#address_type2').css("color","red");return;}else{$j('#address_type2').css("color","");}if(first_name_shipping_value==""){alert(sVM_CONFIRM_FIRST_NAME);$j('#first_name_shipping').css("color","red");return;}else{$j('#first_name_shipping').css("color","");}if(last_name_shipping_value==""){alert(sVM_CONFIRM_LAST_NAME);$j('#last_name_shipping').css("color","red");return;}else{$j('#last_name_shipping').css("color","");}if(address_street_name==""){alert(sVM_CONFIRM_ADDRESS);$j('#address_street_name').css("color","red");return;}else{$j('#address_street_name').css("color","");}if(address_street_number==""){alert(sVM_CONFIRM_ADDRESS);$j('#address_street_number').css("color","red");return;}else{$j('#address_street_number').css("color","");}if(city_shipping_value==""){alert(sVM_CONFIRM_CITY);$j('#city_shipping').css("color","red");return;}else{$j('#city_shipping').css("color","");}if(zip_shipping_value==""){alert(sVM_CONFIRM_ZIP_CODE);$j('#zip_shipping').css("color","red");return;}else{$j('#zip_shipping').css("color","");}if(!isValidZipCode(zip_shipping_value)){alert(sVM_CONFIRM_VALID_ZIP_CODE);$j('#zip_shipping').css("color","red");return;}else{$j('#zip_shipping').css("color","");}if(country_shipping_value==""){alert(sVM_CONFIRM_COUNTRY);$j('#td_country_shipping').css("color","red");return;}else{$j('#td_country_shipping').css("color","");}if(state_shipping_value==""||state_shipping_value=="NA"){alert(sVM_CONFIRM_STATE);$j('#td_state_shipping').css("color","red");return;}else{$j('#td_state_shipping').css("color","");}if(phone_1_shipping_value==""){alert(sVM_CONFIRM_PHONE_NUMBER);$j('#phone_1_shipping').css("color","red");return;}else{$j('#phone_1_shipping').css("color","");}$j.post("index.php",{option:"com_virtuemart",page:"checkout.index",func:func_shipping_value,action:"ajax",address_type:"ST",address_type2:address_type2,user_id:user_id_value,user_info_id:user_info_id_value,company:company_shipping_value,first_name:first_name_shipping_value,last_name:last_name_shipping_value,suite:address_suite,street_number:address_street_number,street_name:address_street_name,city:city_shipping_value,zip:zip_shipping_value,country:country_shipping_value,state:state_shipping_value,phone_1:phone_1_shipping_value,phone_2:phone_2_shipping_value,email:email_shipping_value,current_zip_checked:sCurrentZipChecked,ajaxSend:function(){$j("#msgReportUpdateShipping").html('<img width="24" src="'+sImgLoading+'" align="absmiddle"/>&nbsp;&nbsp;'+sVM_UPDATING_DELIVER_INFO);}},function(data){aData=data.split("[--3--]");if(aData[0]=="success"){$j("#msgReportDeliverInfo").css('display','block');if($j("input[name='func_shipping']").val()=="userAddressUpdate"){$j("#msgReportDeliverInfo").html(sVM_UPDATE_DELIVER_INFO_SUCCESSFUL);}else{$j("#msgReportDeliverInfo").html(sVM_ADD_DELIVER_INFO_SUCCESSFUL);$j("select[name='address_type2']").val("");$j("input[name='user_id_shipping']").val("");$j("input[name='user_info_id_shipping']").val("");$j("input[name='first_name_shipping']").val("");$j("input[name='last_name_shipping']").val("");$j("input[name='company_shipping']").val("");$j("input[name='suite']").val("");$j("input[name='street_number']").val("");$j("input[name='street_name']").val("");$j("input[name='city_shipping']").val("");$j("input[name='zip_shipping']").val("");$j("select[name='state_shipping']").val("");$j("input[name='phone_1_shipping']").val("");$j("input[name='email_shipping']").val("");$j("input[name='phone_2_shipping']").val("");}$j("#listDeliverInfo").html(aData[1]);if(aData[2]){bIsValidZipCodeFirst=1;}changDeliver(oForm.zip_checked.value,aData[2],aData[3]);$j.modal.close();$j("#mainCheckOutForm").css("display","block");$j("#msgReportShippingAddressRadio").css("display","none");}else if(aData[0]=='undeliver'){$j("#msgReportUpdateShipping").html('');alert(sCannotDeliver);return;}else{if($j("input[name='func_shipping']").val()=="userAddressUpdate"){$j("#msgReportUpdateShipping").html(sVM_UPDATE_DELIVER_INFO_UNSUCCESSFUL);}else{$j("#msgReportUpdateShipping").html(sVM_ADD_DELIVER_INFO_UNSUCCESSFUL);}}});});$j("#calculateOrderPrice").click(function(){$j.post("index.php",{option:"com_ajaxorder",task:"validCart",product_number_items:$j("input[name='product_number_items']").val(),ajaxSend:function(){$j("#msgCheckoutReport").html('<img src="'+sImgLoading+'" align="absmiddle"/>&nbsp;&nbsp;'+sVM_VALIDATING_CART);}},function(data){if(data=="reload"){location.href=sSecurityUrl+"index.php?page=checkout.index&option=com_virtuemart&Itemid=80&reload=1";}else{CalculateOrderPrice();$j("#msgCheckoutReport").html("");}});});$j("#saveOrder").click(function(){var popupDate=new Date(new Date().getTime()+24*3600*1000);if(getCookie('shown_popup')!=1){document.cookie="shown_popup=1; path=/; expires="+popupDate;}$j.post("index.php",{option:"com_ajaxorder",task:"validCart",product_number_items:$j("input[name='product_number_items']").val(),ajaxSend:function(){$j("#msgCheckoutReport").html('<img src="'+sImgLoading+'" align="absmiddle"/>&nbsp;&nbsp;'+sVM_VALIDATING_CART2);}},function(data){if(data=="reload"){location.href=sSecurityUrl+"index.php?page=checkout.index&option=com_virtuemart&Itemid=80&reload=1&reload_msg="+sVM_VALIDATING_CART3;}else{$j("#msgCheckoutReport").html("");CalculateOrderPrice();if(parseFloat($j("input[name='total_price']").val())<=0){alert(sEmptyCart);return;}if(!$j.trim($j("#delivery_date_2").val())){alert(sEnterDeliverDay);return;}if(bIsValidDate<=0){alert(sInValidDateTime);return;}if(bIsValidZipCode<=0){alert(sCannotDeliver);return;}myArray={"payment_method":"Payment Method","name_on_card":"Name On Card","credit_card_number":"Credit Card Number","credit_card_security_code":"Cedit Card Security Code","expire_month":"Expire Month"};selectElementArray=new Array("payment_method","expire_month");var objValid="";for(key in myArray){if(jQuery.inArray(key,selectElementArray)!=-1){objValid="select[name='"+key+"']";}else{objValid="input[name='"+key+"']";}if(jQuery.trim($j(objValid).val())==""){alert('Please enter your "'+myArray[key]+'" !');$j(objValid).focus();return;}}$j.ajax({type:"POST",url:"index.php",timeout:20000,async:true,data:({option:"com_ajaxorder",task:"confirmOrder",user_id:$j("input[name='user_id']").val(),user_name:$j("input[name='user_name']").val(),account_email:$j("input[name='account_email']").val(),user_info_id:$j("input[name='ship_to_info_id']:checked").val(),occasion:$j("select[name='customer_occasion']").val(),shipping_method:$j("input[name='shipping_method']").val(),card_msg:$j("textarea[name='card_msg']").val(),signature:$j("textarea[name='signature']").val(),select_bouquet:$j("input[name='select_bouquet']").val(),card_comment:$j("textarea[name='card_comment']").val(),deliver_date:$j("input[name='delivery_date_2']").val(),payment_method_state:$j("input[name='payment_method_state']:checked").val(),payment_method:$j("select[name='payment_method']").val(),name_on_card:$j("input[name='name_on_card']").val(),credit_card_number:$j("input[name='credit_card_number']").val(),credit_card_security_code:$j("input[name='credit_card_security_code']").val(),expire_month:$j("select[name='expire_month']").val(),expire_year:$j("select[name='expire_year']").val(),product_id_string:$j("input[name='product_id_string']").val(),quantity_string:$j("input[name='quantity_string']").val(),total_price:$j("input[name='total_price']").val(),deliver_fee:$j("input[name='deliver_fee']").val(),deliver_fee_type:$j("input[name='deliver_fee_type']").val(),sub_total_price:$j("input[name='sub_total_price']").val(),total_tax:$j("input[name='total_tax']").val(),state_tax:$j("input[name='state_tax']").val(),total_deliver_tax_fee:$j("input[name='total_deliver_tax_fee']").val(),coupon_code_string:$j("input[name='coupon_code_string']").val(),coupon_type_string:$j("input[name='coupon_type_string']").val(),coupon_discount:$j("input[name='coupon_discount']").val(),coupon_code:$j("input[name='coupon_code']").val(),coupon_code_type:$j("input[name='coupon_code_type']").val(),coupon_value:$j("input[name='coupon_value']").val(),product_coupon_string:$j("input[name='product_coupon_string']").val(),vendor_currency_string:$j("input[name='vendor_currency_string']").val(),vendor_currency_string:$j("input[name='vendor_currency_string']").val(),legacy_phone_1:$j("input[name='legacy_phone_1']").val(),legacy_email:$j("input[name='legacy_email']").val(),legacy_password:$j("input[name='legacy_password']").val(),legacy_company:$j("input[name='legacy_company']").val(),legacy_first_name:$j("input[name='legacy_first_name']").val(),legacy_last_name:$j("input[name='legacy_last_name']").val(),legacy_address_suite:$j("input[name='legacy_address_suite']").val(),legacy_address_street_number:$j("input[name='legacy_address_street_number']").val(),legacy_address_street_name:$j("input[name='legacy_address_street_name']").val(),legacy_city:$j("input[name='legacy_city']").val(),legacy_zip:$j("input[name='legacy_zip']").val(),legacy_country:$j("select[name='legacy_country']").val(),legacy_state:$j("select[name='state']").val(),free_shipping:$j("input[name='free_shipping']").val(),find_us:$j("input[name='find_us']:checked").val(),ajaxSend:function(){$j("#order-action-button").css('display','none');$j("#msgCheckoutReport").html('<img src="'+sImgLoading+'" align="absmiddle"/>&nbsp;&nbsp;'+((sLang==='french')?'Ordre est le Traitement':'Order checkout is processing')+'...');}}),success:function(data){aData=data.split("[--1--]");if(jQuery.trim(aData[0])=="success"){window.location.href="index.php?page=checkout.thankyou&order_id="+aData[1]+"&option=com_virtuemart&Itemid=80&msg="+aData[2];}else if(jQuery.trim(aData[0])=="error"){$j("#order-action-button").css('display','block');$j("#msgCheckoutReport").html(aData[1]);}},error:function(x,t,m){if(t=="timeout"){window.location.href="index.php?page=checkout.thankyou&option=com_virtuemart&Itemid=80&msg=error_order";}}});}});});});function editDeliver(user_info_id_value,user_id_value){$j("#updateShippingInfo").attr("value",sVM_UPDATE_ADDRESS);sCurrentZipChecked=$j("input[name='ship_to_info_id']:checked").val();$j.post("index.php",{option:"com_ajaxorder",task:"getUserAddress",user_id:user_id_value,current_zip_checked:sCurrentZipChecked,user_info_id:user_info_id_value},function(data){aData=data.split("[--1--]");if($j.trim(aData[0])=="success"){aData2=aData[1].split("[--2--]");$j("input[name='func_shipping']").val("userAddressUpdate");if(!aData2[16])aData2[16]="R";$j("select[name='address_type2']").val(aData2[16]);$j("input[name='user_id_shipping']").val(aData2[0]);$j("input[name='user_info_id_shipping']").val(aData2[1]);$j("input[name='first_name_shipping']").val(aData2[3]);$j("input[name='last_name_shipping']").val(aData2[4]);$j("input[name='company_shipping']").val(aData2[6]);$j("input[name='city_shipping']").val(aData2[9]);$j("input[name='zip_shipping']").val(aData2[10]);$j("select[name='country_shipping']").val('AUS');changeStateList("state_shipping","country_shipping");$j("select[name='state_shipping']").val(aData2[12]);$j("input[name='phone_1_shipping']").val(aData2[13]);$j("input[name='phone_2_shipping']").val(aData2[14]);$j("input[name='email_shipping']").val(aData2[20]);$j("input[name='address_suite']").val(aData2[17]);$j("input[name='address_street_number']").val(aData2[18]);$j("input[name='address_street_name']").val(aData2[19]);$j('#addShippingInfoForm').modal({onOpen:modalOpen,position:["25%","25%"]});}else{$j("#msgReportDeliverInfo").css('display','block');$j("#msgReportDeliverInfo").html(sVM_LOAD_DELIVER_INFO_FORM_UNSUCCESSFUL);}});}function deleteDeliver(user_info_id_value,user_id_value){sCurrentZipChecked=$j("input[name='ship_to_info_id']:checked").val();$j.post("index.php",{option:"com_virtuemart",page:"account.shipping",func:"useraddressdelete",action:"ajax",user_id:user_id_value,user_info_id:user_info_id_value,current_zip_checked:sCurrentZipChecked,ajaxSend:function(){$j("#msgReportDeliverInfo").css('display','block');$j("#msgReportDeliverInfo").html('<img src="'+sImgLoading+'" align="absmiddle"/>&nbsp;&nbsp;'+sVM_DELETING_DELIVER_INFO);}},function(data){aData=data.split("[--3--]");if(aData[0]=="success"){$j("#msgReportDeliverInfo").css('display','block');$j("#msgReportDeliverInfo").html(sVM_DELETE_DELIVER_INFO_SUCCESSFUL);if(aData[1]=="noshipping"){$j("#msgReportShippingAddressRadio").css("display","block");$j("#listDeliverInfo").html("<input type='hidden' name='zip_checked' value='' >");$j("#mainCheckOutForm").css("display","none");}else{$j("#msgReportShippingAddressRadio").css("display","none");$j("#mainCheckOutForm").css("display","block");$j("#listDeliverInfo").html(aData[1]);changDeliver(oForm.zip_checked.value,aData[2]);}}else{$j("#msgReportDeliverInfo").css('display','block');$j("#msgReportDeliverInfo").html(sVM_DELETE_DELIVER_INFO_UNSUCCESSFUL);}});}function modalOpen(dialog){dialog.overlay.fadeIn('fast',function(){dialog.container.fadeIn('fast',function(){dialog.data.hide().slideDown('fast');});});}function changDeliver(sOptionString,sCurrentStateTax,zipCode){if(zipCode){$j("#post_code_zip_now").val(zipCode);}warehouse_ready=0;part_zipCode=zipCode;n_number=4;i=0;while(n_number>0){for(var key in warehouses_array){if(parseInt(warehouses_array[key][0])==part_zipCode){if(parseInt(warehouses_array[key][1])>0){$j('#message_by_post_code').html("Please note, the minimum purchase for this area is $"+parseInt(warehouses_array[key][1])+".00 including delivery");$j('#message_by_post_code').css('display','block');warehouse_ready=1;n_number=0;break;}}i+=1;}if(warehouse_ready==0){n_number-=1;if(part_zipCode){part_zipCode=part_zipCode.toString();part_zipCode=parseInt(part_zipCode.substr(0,n_number));}}}if(warehouse_ready!=1){$j('#message_by_post_code').hide();}if(!sOptionString){sOptionString="";}if(sCurrentStateTax){$j("input[name='current_state_tax']").val(sCurrentStateTax);}nExtraDayMonth=0;nDaysValid=0;nMonthsValid=0;var sDeliverExtra3="";oForm.zip_checked_value.value=sOptionString;aOption=sOptionString.split("[--1--]");if((aOption[3]==0&&aOption[3]!=null&&sOptionString)||bIsValidZipCodeFirst==0){bIsValidZipCode=0;alert(sCannotDeliver);nMonthsValid=parseFloat(oForm.monthnow.value);nDaysValid=parseFloat(oForm.daynow.value);nYearsValid=parseFloat(nYearNow);return;}else{bIsValidZipCode=1;bIsValidZipCodeFirst=1;}if(isNaN(aOption[2])){aOption[2]=0;}if(isNaN(aOption[1])){aOption[1]=0;}if(aOption[1]==0){sDeliverExtra3=sDeliverExtra2;}else{sDeliverExtra3=sDeliverExtra;}nDeliverExtraPrice=aOption[2];$j("input[name=deliver_extra_price]").val(aOption[2]);$j("input[name=deliver_extra_day]").val(aOption[1]);nDaysOfMonth=parseFloat(oForm.daysofmonthnow.value);nDaysValid=nIndex+parseFloat(aOption[1]);if(parseFloat(oForm.cutofftime.value)>0&&!parseFloat(aOption[1])){nDaysValid=nDaysValid+1;}nMonthsValid=parseFloat(oForm.monthnow.value);nYearsValid=parseFloat(nYearNow);if(nDaysOfMonth<nDaysValid){nExtraDayMonth=nDaysValid-nDaysOfMonth;}if(nExtraDayMonth||parseFloat(oForm.daysofmonthnow.value)<nDaysValid){if(parseFloat(nExtraDayMonth)>0){nDaysValid=nExtraDayMonth;}if(parseFloat(oForm.monthnow.value)==12){nMonthsValid=1;nYearsValid=parseFloat(nYearNow)+1;}else{nMonthsValid=parseFloat(oForm.monthnow.value)+1;nYearsValid=parseFloat(nYearNow);}}if(parseFloat(aOption[1])>0||parseFloat(aOption[2])>0){sDeliverExtra3=sDeliverExtra3.replace("{price}",aOption[2]);sDeliverExtra3=sDeliverExtra3.replace("{day}",aOption[1]);$j("#deliver_extra_post_code").html(sDeliverExtra3);$j("#deliver_extra_post_code").css("display","block");}else{$j("#deliver_extra_post_code").html("");$j("#deliver_extra_post_code").css("display","none");}if(bDefault){bDefault=0;}changeDeliverExtraSameDay();}function changeDeliverExtraSameDay(){sCurrentDate=$j("#delivery_date_2").val();aDate=sCurrentDate.split("/");if(parseFloat(aDate[0])==parseFloat(oForm.monthnow.value)&&parseFloat(aDate[1])==parseFloat(oForm.daynow.value)&&parseFloat(oForm.cutofftime.value)<=0){sDeliverFeeExtraSameDay4=sDeliverFeeExtraSameDay.replace("{price}",parseFloat(nDeliverFeeExtraSameDay));$j("#deliver_extra_same_day").html(sDeliverFeeExtraSameDay4);$j("#deliver_extra_same_day").css("display","block");$j("input[name=deliver_extra_price]").val(parseFloat(nDeliverExtraPrice)+parseFloat(nDeliverFeeExtraSameDay));}else{$j("#deliver_extra_same_day").html("");$j("#deliver_extra_same_day").css("display","none");$j("input[name=deliver_extra_price]").val(parseFloat(nDeliverExtraPrice));$j("input[name=deliver_extra_day]").val(0);}nSpecialDeliverExtraPrice=isSpecialDate(parseFloat(aDate[0]),parseFloat(aDate[1]));if(nSpecialDeliverExtraPrice>0){$j("input[name=deliver_extra_price]").val(parseFloat($j("input[name=deliver_extra_price]").val())+parseFloat(nSpecialDeliverExtraPrice));}}function noticeDeliver(){var sDeliverExtra3="";aOption=oForm.zip_checked_value.value.split("[--1--]");sCurrentDate=$j("#delivery_date_2").val();aDate=sCurrentDate.split("/");if((parseFloat(aDate[0])<nMonthsValid&&nMonthNow!=12)||(parseFloat(aDate[0])==nMonthsValid&&parseFloat(aDate[1])<nDaysValid)){alert(sInValidDateTime);bIsValidDate=0;return;}if(isUnAvailableDate(parseFloat(aDate[0]),parseFloat(aDate[1]))){$j("#deliver_extra_same_day").html(sNoDeliveryService);$j("#deliver_extra_same_day").css("display","block");$j("#deliver_extra_post_code").css("display","none");bIsValidDate=0;return;}if((parseFloat(aDate[0])<nMonthsValid&&nMonthsValid!=12)||(parseFloat(aDate[0])==nMonthsValid&&parseFloat(aDate[1])<nDaysValid)){$j("#deliver_extra_same_day").html(sInValidDateTime);$j("#deliver_extra_same_day").css("display","block");$j("#deliver_extra_post_code").css("display","none");$j("input[name=deliver_extra_price]").val(0);$j("input[name=deliver_extra_day]").val(0);bIsValidDate=0;}else{$j("#deliver_extra_post_code").css("display","block");bIsValidDate=1;}if(!isUnAvailableDate(parseFloat(aDate[0]),parseFloat(aDate[1]))){changeDeliverExtraSameDay();}}function CalculateOrderPrice(){nTotalItemPrice=parseFloat($j("input[name=sub_total_price]").val());nTotalDeliveryFee=parseFloat($j("input[name=deliver_fee]").val());nTotalPrice=nTotalItemPrice+nTotalDeliveryFee;if(bIsValidZipCode<=0){alert(sCannotDeliver);return;}$j("#calcualte-total-items-price").html("$"+formatAsMoney(nTotalItemPrice));$j('#calcualte-total-deliver-fee').html('$'+formatAsMoney(nTotalDeliveryFee));$j("#calcualte-total-price").html("$"+formatAsMoney(nTotalPrice));$j("input[name='total_price']").val(parseFloat(nTotalPrice));}function changeUnAvailableDate(nCurrentMonth){if(sUnAvailableDate){aUnAvailableDate=sUnAvailableDate.split("[--1--]");nCurrentMonth=parseFloat(nCurrentMonth);var aItem=new Array();var k=0;for(i=0;i<aUnAvailableDate.length;i++){if(aUnAvailableDate[i]!=""){aUnAvailableItem=aUnAvailableDate[i].split("/");if(nCurrentMonth==aUnAvailableItem[0]){aItem[k]=aUnAvailableItem[1];k++;}}}for(i=1;i<oForm.delivery_day2.length;i++){oForm.delivery_day2.options[i].text=oForm.delivery_day2.options[i].value;oForm.delivery_day2.options[i].style.color="black";}for(i=0;i<aItem.length;i++){oForm.delivery_day2.options[aItem[i]].text=oForm.delivery_day2.options[aItem[i]].text+" - No delivery service  ";oForm.delivery_day2.options[aItem[i]].style.color="red";}}}function getTaxFollowDeliveryInfo(sCountry,sState){if(sStateTax&&sCountry&&sState){aStateTax=sStateTax.split("[--2--]");for(i=0;i<aStateTax.length;i++){aStateTaxItem=aStateTax[i].split("[--1--]");if(aStateTaxItem[0]==sCountry&&aStateTaxItem[1]==sState){return aStateTaxItem[2];}}}return-1;}function isUnAvailableDate(nCurrentMonth,nCurrentDay){if(sUnAvailableDate){aUnAvailableDate=sUnAvailableDate.split("[--1--]");for(i=0;i<aUnAvailableDate.length;i++){if(aUnAvailableDate[i]){aUnAvailableItem=aUnAvailableDate[i].split("/");if(nCurrentMonth==aUnAvailableItem[0]&&nCurrentDay==aUnAvailableItem[1]){return true;break;}}}return false;}}function isSpecialDate(nCurrentMonth,nCurrentDay){if(sSpecialDeliver){aSpecialDeliver=sSpecialDeliver.split("[--1--]");for(i=0;i<aSpecialDeliver.length;i++){if(aSpecialDeliver[i]){aSpecialDeliverItem=aSpecialDeliver[i].split("/");if(nCurrentMonth==aSpecialDeliverItem[0]&&nCurrentDay==aSpecialDeliverItem[1]){return aSpecialDeliverItem[2];break;}}}return 0;}}function validDeliverDate(submit_action){oForm=document.adminForm;$nExtraDay=$j("input[name=deliver_extra_day]").val();sCurrentDate=$j("#delivery_date_2").val();aDate=sCurrentDate.split("/");if(oForm.delivery_day2.value==0){alert(sEnterDeliverDay);return;}if(oForm.delivery_month2.value==0){alert(sEnterDeliverMonth);return;}if(parseFloat(aDate[0])<nMonthsValid||parseFloat(aDate[1])<nDaysValid){alert(sInValidDateTime);return;}if(isUnAvailableDate(parseFloat(aDate[0]),parseFloat(aDate[1]))){alert(sNoDeliveryService);return;}oForm.delivery_day.value=oForm.delivery_day2.value;oForm.delivery_month.value=oForm.delivery_month2.value;if(submit_action){oForm.submit();}}function getDeliverMethodFee(methodID,sType){if(sDeliverMethodFee){aDeliverMethodFee=sDeliverMethodFee.split("[--2--]");for(i=0;i<aDeliverMethodFee.length;i++){if(aDeliverMethodFee[i]){aDeliverMethodFeeItem=aDeliverMethodFee[i].split("[--1--]");if(methodID==aDeliverMethodFeeItem[0]){if(sType=="tax"){return aDeliverMethodFeeItem[2];}else{return aDeliverMethodFeeItem[1];}break;}}}return 0;}}function changeStateList(state_list_name,element_country_id){if(!element_country_id){element_country_id='country_billing';}if(!state_list_name){state_list_name='state_billing';}if(element_country_id=="country_shipping"){selected_country="AUS";}else if(element_country_id=="AUS"){selected_country="AUS";}else{var nSelectIndex=document.getElementById(element_country_id).selectedIndex;var selected_country=document.getElementById(element_country_id).options[nSelectIndex].value;}if($j('#country_billing').val()=='AUS'){$j("input[name='phone_1_billing']").attr('maxlength','10');$j("input[name='phone_1']").attr('maxlength','10');$j("input[name='phone_1']").attr('placeholder','10 digits, no spaces');$j("input[name='phone_1_billing']").attr('placeholder','10 digits, no spaces');}else{$j("input[name='phone_1_billing']").attr('maxlength','35');$j("input[name='phone_1']").attr('maxlength','35');$j("input[name='phone_1']").attr('placeholder','');$j("input[name='phone_1_billing']").attr('placeholder','');}if(!document.getElementById(state_list_name)){state_list_name='state';}changeDynaList2(state_list_name,eval(state_list_name),selected_country,"","");}function changeDynaList2(listname,source,key,orig_key,orig_val){var list2=document.getElementById(listname);for(i in list2.options.length){list2.options[i]=null;}i=0;s="";for(x in source){if(source[x][0]==key){opt=new Option();opt.value=source[x][1];opt.text=source[x][2];if((orig_key==key&&orig_val==opt.value)||i==0){opt.selected=true;}list2.options[i++]=opt;}}list2.length=i;}function isValidZipCode(value){var re=/^[0-9\s]{4,5}$/;return(re.test(value));}function social_login(social){window.open("/index.php?option=social_login&ok=1&social="+social);}function isInteger(s){var i;if(isEmpty(s))if(isInteger.arguments.length==1)return 0;else
return(isInteger.arguments[1]==true);for(i=0;i<s.length;i++){var c=s.charAt(i);if(!isDigit(c))return false;}return true;}function isEmpty(s){return((s==null)||(s.length==0));}function isDigit(c){return((c>="0")&&(c<="9"));}function formatAsMoney(mnt){mnt-=0;mnt=(Math.round(mnt*100))/100;return(mnt==Math.floor(mnt))?mnt+'.00':((mnt*10==Math.floor(mnt*10))?mnt+'0':mnt);}function trim(str,chars){return ltrim(rtrim(str,chars),chars);}function ltrim(str,chars){chars=chars||"\\s";return str.replace(new RegExp("^["+chars+"]+","g"),"");}function rtrim(str,chars){chars=chars||"\\s";return str.replace(new RegExp("["+chars+"]+$","g"),"");}function searchRedirect(url,last_keyword){$j.post("index.php",{option:"com_instant_search",task:"save_keyword",keyword:last_keyword,ajaxSend:function(){}},function(data){location.href=url;});}